/*
* Kendo UI Complete v2012.1.322 (http://kendoui.com)
* Copyright 2012 Telerik AD. All rights reserved.
*
* Kendo UI Complete commercial licenses may be obtained at http://kendoui.com/complete-license
* If you do not own a commercial license, this file shall be governed by the trial license terms.
*/
(function(a,b){function M(){return Math.abs(window.orientation)/90?"km-horizontal":"km-vertical"}function L(b){J(a(b.currentTarget))&&b.preventDefault()}function K(b){if(!(b.which>1)){var c=a(b.currentTarget),e=c.attr(z);!b.isDefaultPrevented()&&J(c)&&(e&&e!=A&&(c.attr(z,A),setTimeout(function(){c.attr(z,e)}),d.navigate(e)),b.preventDefault())}}function J(a){return a.data(c.ns+"rel")!="external"}function I(a){B.test(a)&&(a=RegExp.$1),r[0].innerHTML=a;return r}function H(a){return a.replace(/(\S+)/g,"["+h("role")+"=$1],")}var c=window.kendo,d=c.history,e=c.support,f=c.mobile,g=c.roleSelector,h=c.attr,i=f.View,j=f.ViewSwitcher,k=f.Layout,l=e.mobileOS,m,n,o,p={ios:"iPhone OS 4_3",android:"Android 2.3.3",blackberry:"PlayBook Version/7.2.0.0",meego:"MeeGo NokiaBrowser/8.5.0"},q=e.transitions.css+"transform",r=a("<div/>"),s='<meta name="apple-mobile-web-app-capable" content="yes" /> \n                <meta name="apple-mobile-web-app-status-bar-style" content="black" /> \n                <meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" name="viewport" />',t=c.template('<link rel="apple-touch-icon'+(e.mobileOS.android?"-precomposed":"")+'" # if(data.size) { # sizes="#=data.size#" #}# href="#=data.icon#" />',{usedWithBlock:!1}),u=H("button backbutton detailbutton listview-link"),v=H("tab"),w="onorientationchange"in window?"orientationchange":"resize",x=l.device=="iphone"||l.device=="ipod",y=60,z="href",A="#!",B=/<body[^>]*>(([\u000a\u000d\u2028\u2029]|.)*)<\/body>/i,C=window.scrollTo,D=a(window),E=a("head"),F=["touchstart","touchend","touchmove","mousedown","mousemove","mouseup"],G=a.proxy,N=c.Observable.extend({init:function(b,d){var e=this;e.layouts={},e.options=a.extend({hideAddressBar:!0},d),c.Observable.fn.init.call(e,e.options),e.element=b?a(b):a(document.body),a(function(){e._setupPlatform(),e._attachHideBarHandlers(),e._setupElementClass(),e._attachMeta(),e._loader(),e._setupAppLinks(),e._setupLayouts(e.element),e._startHistory(),e._attachCapture()})},navigate:function(a){var b=this;b.transitioning=!0,b._findView(a,function(c){b.view!==c&&(d.navigate(a,!0),(new j(b)).replace(b.view,c),b.view=c)})},scroller:function(){return this.view.content.data("kendoScroller")},hideLoading:function(){var a=this;clearTimeout(a._loading),a.loader.hide()},showLoading:function(){var a=this;a.options.loading!==!1&&(a._loading=setTimeout(function(){a.loader.show()},100))},_setupAppLinks:function(){this.element.delegate(v,e.mousedown,K).delegate(u,e.mouseup,K).delegate(v+u,"click",L)},_setupPlatform:function(){var a=this,b=a.options.platform,c=typeof b=="string";b&&(l=c?e.detectOS(p[b]):b,e.mobileOS=l),m=l?l.name:"ios",n="km-"+m,o=n+(l?" "+n+l.majorVersion:"")+(l.appMode?" km-app":"")},_setupLayouts:function(d){var e=this,f=c.ns+"platform";d.find(g("layout")).each(function(){var d=a(this),g=d.data(f);if(g===b||g===m)e.layouts[d.data("id")]=c.initWidget(d,{},c.mobile.ui)})},_startHistory:function(){var b=this,c,e,f=b.options.initial;c=b.element.find(g("view")),b.rootView=c.first(),e={change:function(a){b.navigate(a.string)},ready:function(a){var e=a.string,g=!e&&f;g&&(e=f),b._findView(e,function(a){c.not(a).hide(),a.onShowStart(),b.view=a,g&&d.navigate(f,!0)})}},d.start(a.extend(b.options,e))},_createView:function(a){var b=this,d=b.dataOrDefault(a,"layout");d&&(d=b.layouts[d]);var e=c.initWidget(a,{application:this,layout:d},c.mobile.ui);return e},_createRemoteView:function(b,c){var d=this,e=a(I(c)),f=e.find(g("view")).hide(),i=e.find(g("layout")),j=e.find("script, style"),k=f.first(),l;k.hide().attr(h("url"),b),d._setupLayouts(e),d.element.append(i),d.element.append(j),d.element.append(f),l=d._createView(k);return l},_findView:function(b,c){var d=this,e,f=b.charAt(0),g=f==="#",i=f==="/",j;b?(j=d.element.find("["+h("url")+"='"+b+"']"),!j[0]&&!i&&(j=d.element.find(g?b:"#"+b))):j=d.rootView,e=j.data("kendoView"),e?c(e):j[0]?c(d._createView(j)):(d._xhr&&d._xhr.abort(),d.showLoading(),d._xhr=a.get(b,function(a){c(d._createRemoteView(b,a)),d.hideLoading()}).fail(function(){d.hideLoading()}))},_setupElementClass:function(){var a=this,b=a.options.platform?"km-"+a.options.platform:o,c=a.element;c.parent().addClass("km-root"),c.addClass(b+" "+M()),D.bind(w,function(b){c.removeClass("km-horizontal km-vertical").addClass(M()),a.view&&a.view.scroller.reset()})},_attachMeta:function(){var a=this.options.icon,b;E.prepend(s);if(a){typeof a=="string"&&(a={"":a});for(b in a)E.prepend(t({icon:a[b],size:b}))}},_attachHideBarHandlers:function(){var a=this;!l.appMode&&!!a.options.hideAddressBar&&(a._initialHeight={},a._lastOrientation=-1,x&&D.bind("load "+w,G(a._hideBar,a)))},_hideBar:function(){var a=this,b=a.element,c=window.orientation+"",d=a._initialHeight,e=a._lastOrientation,f;e!==c&&(a._lastOrientation=c,d[c]||(d[c]=D.height()),f=d[c]+y,f!=b.height()&&(b.height(f),setTimeout(C,0,0,1)))},_attachCapture:function(){function b(b){a.transitioning&&b.stopPropagation()}var a=this;a.transitioning=!1;for(var c=0;c<F.length;c++)a.element[0].addEventListener(F[c],b,!0)},dataOrDefault:function(a,b){return typeof a.data(c.ns+b)!="undefined"?a.data(b):this.options[b]},_loader:function(){var c=this,d=c.options.loading;d===b&&(d="<h1>Loading...</h1>"),c.loader=a('<div class="km-loader"><span class="km-loading km-spin"></span>'+d+"</div>").hide().appendTo(c.element)}});c.mobile.Application=N})(jQuery)